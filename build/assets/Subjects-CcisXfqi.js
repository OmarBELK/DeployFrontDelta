import{R as M,r as l,j as e,L as T,D as L,M as g,E as I,S as V,T as P,C as q,a as H,B as K,H as R,g as B,h as F}from"./index-DoJY8-2y.js";function $({subject:c,onClose:i}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:c.nom_matiere})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:c.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created At"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(c.created_at).toLocaleDateString()})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})}function W(){const[c,i]=M.useState(!1),[y,b]=l.useState(!1),[N,h]=l.useState(!1),[v,j]=l.useState(!1),[n,o]=l.useState(null),[u,m]=l.useState([]);l.useState(!1);const[x,p]=l.useState(null),w=[{header:"Subject Name",accessorKey:"nom_matiere",cell:({row:t})=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:t.original.nom_matiere})},{header:"Description",accessorKey:"description"},{header:"Created At",accessorKey:"created_at",cell:({row:t})=>new Date(t.original.created_at).toLocaleDateString()},{header:"Actions",id:"actions",cell:({row:t})=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{var a,s;return(s=(a=t.original).onView)==null?void 0:s.call(a,t.original)},className:"p-1 text-blue-600 hover:text-blue-800",children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var a,s;return(s=(a=t.original).onEdit)==null?void 0:s.call(a,t.original)},className:"p-1 text-gray-600 hover:text-gray-800",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(t.original.id),className:"p-1 text-gray-600 hover:text-gray-800",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx(q,{isOpen:x!==null,onConfirm:async()=>{await H.delete(`http://162.19.205.65:81/matieres/delete/${x}/`,{headers:{"Content-Type":"application/json"}}),m(u.filter(a=>a.id!==x)),p(null),K.error("Deleted Successfully",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",transition:R})},onCancel:()=>p(null),message:"Do you really want to delete."})]})}];l.useEffect(()=>{fetch("http://162.19.205.65:81/matiere_list/").then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{m(t),i(!1)}).catch(t=>{i(!1)})},[x]);const C=t=>{({...t,created_at:new Date().toISOString()})},k=t=>{if(!n)return;const a=u.map(s=>s.id===n.id?{...s,...t}:s);m(a)},E=t=>{o(t),j(!0)},O=t=>{o(t),h(!0)},_=u.map(t=>({...t,onView:E,onEdit:O}));if(c)return e.jsx(T,{});function f({onSubmit:t,onClose:a,initialData:s}){const[r,S]=l.useState({nom_matiere:(s==null?void 0:s.nom_matiere)||"",description:(s==null?void 0:s.description)||""}),A=async d=>{d.preventDefault();const D=s?await F(r,s.id):await B(r);m([...u,D]),t(r),a()};return e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject Name"}),e.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",value:r.nom_matiere,onChange:d=>S({...r,nom_matiere:d.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{required:!0,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",value:r.description,onChange:d=>S({...r,description:d.target.value})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:s?"Update Subject":"Add Subject"})]})]})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subjects"}),e.jsx("button",{onClick:()=>b(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Add Subject"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx(L,{columns:w,data:_,searchPlaceholder:"Search subjects..."})}),e.jsx(g,{isOpen:y,onClose:()=>b(!1),title:"Add New Subject",children:e.jsx(f,{onSubmit:C,onClose:()=>b(!1)})}),e.jsx(g,{isOpen:N,onClose:()=>{h(!1),o(null)},title:"Edit Subject",children:n&&e.jsx(f,{onSubmit:k,onClose:()=>{h(!1),o(null)},initialData:n})}),e.jsx(g,{isOpen:v,onClose:()=>{j(!1),o(null)},title:"Subject Details",children:n&&e.jsx($,{subject:n,onClose:()=>{j(!1),o(null)}})})]})}export{W as default};
